### 시스템 프로그래밍의 기반 요소

- systemcall
- C 라이브러리
- C 컴파일러
  > 사용자 영역에서 시스템 프로그래밍

---

### systemcall

- systemcall: 운영체제 리소스나 서비스 요청을 위해 사용자 영역에서 커널 영역으로 들어가는 함수
- 주요 systemcall: read(), write(), open() 등
  > 리눅스, 유닉스느 C언어로 만들어져 있으므로 시스템콜도 C언어로 구현

---

### 시스템콜은 어떻게 구현?

- eax 레지스터에 시스템콜 번호를 넣고,
- ebx 레지스터에는 시스템콜에 해당하는 인자값을 넣고,
- 소프트웨어 인터럽트 명령을 호출하면서 0x80값을 넘겨줌
  <center><image src='./images/systemcallhow.png' width=700 ></center>

---

### 시스템콜은 어떻게 구현?

- 소프트웨어 인터럽트 명령을 호출하면서 0x80값을 넘겨줌
  1. CPU는 사용자 모드를 커널 모드로 바꿈
  2. IDT(Interrupt Descriptor Table)에서 0x80에 해당하는 함수(=system_call)가 저장되어 있는 주소를 찾아서 PC(Program Counter) 레지스터에 주면 실행함
  3. system_call() 함수에서 eax로부터 시스템콜 번호를 찾아서 해당 번호에 맞는 시스템콜 함수를 찾음
  4. 해당 시스템콜 함수 실행 후, 다시 커널 모드에서 사용자 모드로 변경하고 다음 코드 진행
  <center><image src='./images/InterruptDescriptionTable.png' width=400 ></center>

---

### API

- API란? 시스템콜은 너무 어려웡. 프로그래머가 사용하기 쉽게 해줘
- 응용 프로그램과 분리된 하위 호환 인터페이스
  - 예: 시스템콜 래퍼, 입출력 라이브러리 등등

---

### C라이브러리

- 유닉스 C라이브러리 - libc
- 리눅스 C라이브러리 - GNU libc - glibc (지립씨, 글립씨)
  - 시스템콜, 시스템콜 래퍼, 기본 응용 프로그램 기능 포함

---

### C컴파일러

- 유닉스 C컴파일러 - cc
- 리눅스 C컴파일러 - GNU cc - gcc (지씨씨)
- 우분투 리눅스에 gcc 설치
  <center><image src='./images/linux-installgcc.png' width=600 ></center>

---

### ABI (Application Binary Interface)

- 응용프로그램 바이너리 인터페이스
- 함수 실행 방식, 레지스터 활용, 시스템콜 실행, 라이브러리 링크 방식 등
- ABI가 호환되면 재컴파일없이 동작
- 컴파일러, 링커(라이브러리 링크), 툴체인(컴파일러를 만드는 프로그램)에서 제공

---

### POSIX

- 유닉스 시스템 프로그래밍 표준 (API, ABI의 표준을 정하자~)
- IEEE(Institution of Electronic and Electronics Engineers)에서 표준화 시도
- 리차드 스톨만(자유 소프트웨어 재단)이 POSIX를 표준안 이름으로 제안

---

### C언어 표준

- 다양한 C 언어 변종
- ANSI(American National Standards Institute)에서 ANSI C 표준 정립
  > 리눅스는 POSIX와 ANSI C 지원

---

### 시스템 프로그래밍과 버전

- 끊임없는 POSIX, C, C++ 표준 업데이트
- 끊임없는 소프트웨어 업데이트
- 프로그래밍 트렌드와 상관없이 시스템 레벨단 기술은 유지되고 필요함
  > 상위 레벨 프로그래밍을 할지라도 하위 시스템 레벨을 알고 있으면, 더 나은 또는 성능이 개선된 소프트웨어 개발 가능
